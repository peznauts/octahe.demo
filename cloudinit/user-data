#cloud-config

password: Password1
chpasswd: { expire: False }

# Hostname management
preserve_hostname: False
hostname: REPLACEME
fqdn: REPLACEME.localdomain

# Setup Users with ssh keys so that I can log in into new machine
users:
- default
- name: vm-user
  groups: []
  shell: /bin/bash
  sudo: ALL=(ALL) NOPASSWD:ALL
  ssh_pwauth: True
  ssh-authorized-keys:
  - REPLACEKEY

# Configure where output will go
output:
  all: ">> /var/log/cloud-init.log"

# configure interaction with ssh server
ssh_svcname: ssh
ssh_deletekeys: True
ssh_genkeytypes:
- rsa
- ecdsa
ssh_pwauth: True
ssh_authorized_keys:
- REPLACEKEY

# set timezone for VM
timezone: UTC
packages:
- NetworkManager
- qemu-guest-agent
- vim
- network-scripts
- patch
- git
- patchutils
- iptables-services
- python*-virtualenv
- tmux
- OpenIPMI
- ipmitool

runcmd:
- systemctl enable qemu-guest-agent
- systemctl restart qemu-guest-agent
- systemctl enable sshd
- systemctl restart sshd
- systemctl enable NetworkManager
- systemctl start NetworkManager
- timedatectl set-timezone UTC
- hostnamectl --static --transient set-hostname REPLACEME.localdomain
